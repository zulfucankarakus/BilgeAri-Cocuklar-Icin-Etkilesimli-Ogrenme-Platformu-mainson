@model BilgeAriMVC.Models.LoginViewModel
@{
    ViewData["Title"] = "Giri≈ü Yap";
    Layout = "_Layout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/login.css" asp-append-version="true" />
}

<div class="login-page">

    <div class="header">
        <h1>üêù BeeLearn</h1>
        <p>Bilge Arƒ± d√ºnyasƒ±na ho≈ü geldin!</p>
    </div>

    <div class="login-container">
        <div class="login-box">

            <h2>Giri≈ü Yap</h2>

            <form id="loginForm" asp-controller="Auth" asp-action="Login" method="post">
                @Html.AntiForgeryToken()

                <label>E-posta</label>
                <input type="email" asp-for="Email" id="email" placeholder="E-posta adresin" required>
                <span asp-validation-for="Email" class="text-danger"></span>

                <label>≈ûifre</label>
                <input type="password" asp-for="Password" id="password" placeholder="≈ûifren" required>
                <span asp-validation-for="Password" class="text-danger"></span>

                <button type="submit">Giri≈ü Yap</button>

                <p id="loginMessage"></p>

                <div class="links">
                    <a asp-controller="Auth" asp-action="Forgot">≈ûifremi unuttum</a>
                    <a asp-controller="Auth" asp-action="Signup">Kayƒ±t ol</a>
                </div>

            </form>

        </div>
    </div>

</div>

@section Scripts {
    <script>
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const messageEl = document.getElementById('loginMessage');
            const formData = new FormData(this);
            
            try {
                const response = await fetch(this.action, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                messageEl.textContent = result.message;
                messageEl.style.color = result.success ? 'green' : 'red';
                
                if (result.success) {
                    setTimeout(() => {
                        window.location.href = '@Url.Action("Index", "Home")';
                    }, 1000);
                }
            } catch (error) {
                messageEl.textContent = 'Bir hata olu≈ütu. L√ºtfen tekrar deneyin.';
                messageEl.style.color = 'red';
            }
        });
    </script>
}
