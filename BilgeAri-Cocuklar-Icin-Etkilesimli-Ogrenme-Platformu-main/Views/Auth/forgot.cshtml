@model BilgeAriMVC.Models.ForgotPasswordViewModel
@{
    ViewData["Title"] = "≈ûifremi Unuttum";
    Layout = "_Layout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/forgot.css" asp-append-version="true" />
}

<div class="forgot-page">

    <div class="header">
        <h1>üêù BeeLearn</h1>
        <p>≈ûifreni unuttuysan merak etme, hallederiz!</p>
    </div>

    <div class="login-container">
        <div class="login-box">

            <h2>≈ûifre Yenileme</h2>

            <form id="resetForm" asp-controller="Auth" asp-action="Forgot" method="post">
                @Html.AntiForgeryToken()

                <label>E-posta</label>
                <input type="email" asp-for="Email" id="email" placeholder="Kayƒ±tlƒ± e-posta" required>
                <span asp-validation-for="Email" class="text-danger"></span>

                <label>Favori Pozitif Sayƒ±n</label>
                <input type="number" asp-for="FavoriteNumber" id="fav" placeholder="Pozitif sayƒ± gir" required>
                <span asp-validation-for="FavoriteNumber" class="text-danger"></span>

                <button type="submit">Baƒülantƒ± G√∂nder</button>

                <p id="resetMessage"></p>

                <div class="links">
                    <a asp-controller="Auth" asp-action="Login">‚Üê Giri≈üe D√∂n</a>
                </div>

            </form>

        </div>
    </div>

</div>

@section Scripts {
    <script>
        document.getElementById('resetForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const messageEl = document.getElementById('resetMessage');
            const formData = new FormData(this);
            
            try {
                const response = await fetch(this.action, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                messageEl.textContent = result.message;
                messageEl.style.color = result.success ? 'green' : 'red';
                
                if (result.success) {
                    setTimeout(() => {
                        window.location.href = '@Url.Action("Login", "Auth")';
                    }, 2000);
                }
            } catch (error) {
                messageEl.textContent = 'Bir hata olu≈ütu. L√ºtfen tekrar deneyin.';
                messageEl.style.color = 'red';
            }
        });
    </script>
}
